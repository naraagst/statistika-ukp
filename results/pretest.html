<html>
	<head>
		<title>STATISTIKA</title>
	
		<link href="/assets/css/statistik.css" rel="stylesheet">	
		<link href="style.css" rel="stylesheet">	
		<link rel='stylesheet' href='https://use.fontawesome.com/releases/v5.7.0/css/all.css' integrity='sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ' crossorigin='anonymous'>	
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta http-equiv="ScreenOrientation" content="autoRotate:disabled">
	</head>
	<body>
		<div class="header">
			<img src="/assets/gambar/logo.png" id="logo" style="float:left"/>
			<a href="javascript:void(0);" class="iconmenu" onclick="sidebar()"><i class="fa fa-bars"></i></a>
		</div>
		<div class="sidebar" id="sidebar">
		</div>
		<div class="content">
			<center>
			<div class="isiHasil">
			<h1>Hasil Pretest</h1>
			<button id="btnExport" onclick="fnExcelReport();" class="cek" style="margin:10px 0; width:200px !important;"> Download File Excel </button>
			<div class="tabel">
				<table id="tblData2">
					<thead>
						<tr>
							<th>No. </th>
							<th>Nama</th>
							<th>Kelas</th>
							<th>Nilai</th>
							<th>Waktu Selesai</th>
						</tr>
					</thead>
					<tbody id="data">
						<!-- <tr>
							<td colspan="5" style="text-align:center">Belum Ada Data</td>
						</tr> -->
					</tbody>
				</table>
			</div>
			</div>
			</center>
		</div>
		<script src="sidebar.js"></script>
		<!-- The core Firebase JS SDK is always required and must be listed first -->
		<script src="https://www.gstatic.com/firebasejs/7.17.1/firebase-app.js"></script>

		<!-- TODO: Add SDKs for Firebase products that you want to use
		     https://firebase.google.com/docs/web/setup#available-libraries -->
		<script src="https://www.gstatic.com/firebasejs/7.17.1/firebase-analytics.js"></script>
		<script src="https://www.gstatic.com/firebasejs/7.17.1/firebase-database.js"></script>
		<script>
		// Your web app's Firebase configuration
		  var firebaseConfig = {
		    apiKey: "AIzaSyA0bSfBNKA4Y3oDbiorSA8dYrI6X7thQpI",
		    authDomain: "statistika-smp.firebaseapp.com",
		    databaseURL: "https://statistika-smp.firebaseio.com",
		    projectId: "statistika-smp",
		    storageBucket: "statistika-smp.appspot.com",
		    messagingSenderId: "221055005685",
		    appId: "1:221055005685:web:6704d25858af96560426bc",
		    measurementId: "G-SD240GBRWE"
		  };
		  // Initialize Firebase
		  firebase.initializeApp(firebaseConfig);

		var database = firebase.database();
		var data = database.ref('pretest');
		var index = 0;
		data.on('value', function(snapshot) {
		  snapshot.forEach(function(childSnapshot) {
		    index+=1;
		    var hasil = childSnapshot.val();
		    var tblData = document.getElementById("data");
		    tblData.innerHTML += `
		      <tr>
		        <td>${index}.</td>
		        <td>${hasil.nama}</td>
		        <td>${hasil.kelas}</td>
		        <td>${hasil.nilai}</td>      
		        <td>${hasil.tanggal}<br/>${hasil.waktu}</td>      
		      </tr>
		    `
		  })
		});

		function fnExcelReport()
		{
		    var tab_text="<table border='2px'><tr bgcolor='#87AFC6'>";
		    var textRange; var j=0;
		    tab = document.getElementById('tblData2'); // id of table

		    for(j = 0 ; j < tab.rows.length ; j++) 
		    {     
		        tab_text=tab_text+tab.rows[j].innerHTML+"</tr>";
		        //tab_text=tab_text+"</tr>";
		    }

		    tab_text=tab_text+"</table>";
		    tab_text= tab_text.replace(/<A[^>]*>|<\/A>/g, "");//remove if u want links in your table
		    tab_text= tab_text.replace(/<img[^>]*>/gi,""); // remove if u want images in your table
		    tab_text= tab_text.replace(/<input[^>]*>|<\/input>/gi, ""); // reomves input params

		    var ua = window.navigator.userAgent;
		    var msie = ua.indexOf("MSIE "); 

		    if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./))      // If Internet Explorer
		    {
		        txtArea1.document.open("txt/html","replace");
		        txtArea1.document.write(tab_text);
		        txtArea1.document.close();
		        txtArea1.focus(); 
		        sa=txtArea1.document.execCommand("SaveAs",true,"Say Thanks to Sumit.xls");
		    }  
		    else                 //other browser not tested on IE 11
		        sa = window.open('data:application/vnd.ms-excel,' + encodeURIComponent(tab_text));  

		    return (sa);
		}

		</script>
	</body>
	
</html>